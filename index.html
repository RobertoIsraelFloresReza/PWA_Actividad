<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bar Cocktail Finder</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #ff6b6b;
            --secondary: #4ecdc4;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --accent: #ffd166;
        }
        
        body {
            background: linear-gradient(to right, #1a2a6c, #b21f1f, #fdbb2d);
            color: var(--light);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .navbar {
            background: rgba(26, 26, 46, 0.9) !important;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .logo-text {
            font-family: 'Brush Script MT', cursive;
            font-size: 2rem;
            color: var(--accent);
        }
        
        .search-container {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .search-input {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50px;
            color: white;
            padding: 15px 25px;
            backdrop-filter: blur(10px);
        }
        
        .search-input:focus {
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 0.25rem rgba(255, 107, 107, 0.25);
            color: white;
        }
        
        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .filter-buttons .btn {
            margin: 5px;
            border-radius: 20px;
            transition: all 0.3s;
        }
        
        .cocktail-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: 100%;
        }
        
        .cocktail-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
        }
        
        .cocktail-image {
            height: 250px;
            object-fit: cover;
            width: 100%;
        }
        
        .cocktail-name {
            font-size: 1.4rem;
            color: var(--accent);
            font-weight: bold;
        }
        
        .instructions-btn {
            background: var(--secondary);
            border: none;
            border-radius: 20px;
            padding: 10px 20px;
            transition: all 0.3s;
        }
        
        .instructions-btn:hover {
            background: #3aa89b;
            transform: scale(1.05);
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: white;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-title {
            color: var(--accent);
        }
        
        .close-btn {
            color: white;
            opacity: 0.8;
        }
        
        .ingredient-list {
            list-style-type: none;
            padding: 0;
        }
        
        .ingredient-list li {
            padding: 5px 0;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
        }
        
        .loading-spinner {
            width: 3rem;
            height: 3rem;
            color: var(--primary);
        }
        
        .alcohol-indicator {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
        }
        
        .search-type-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--primary);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
        }
        
        .floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            transition: all 0.3s;
        }
        
        .floating-btn:hover {
            transform: scale(1.1) rotate(180deg);
            background: #ff5252;
        }
        
        .toast {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--dark);
            color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }
        
        @media (max-width: 768px) {
            .cocktail-card {
                margin-bottom: 20px;
            }
            
            .floating-btn {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
            }
        }
        
        .glass-icon {
            font-size: 1.5rem;
            margin-right: 10px;
        }
        
        .search-info {
            font-size: 0.9rem;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-cocktail glass-icon"></i>
                <span class="logo-text">Bar Cocktail Finder</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container my-5">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-8">
                <div class="text-center mb-5">
                    <h1 class="display-4 fw-bold mb-3">Encuentra tu cóctel perfecto</h1>
                </div>
                
                <!-- Search Box -->
                <div class="search-container mb-4">
                    <div class="input-group">
                        <input type="text" id="searchInput" class="form-control search-input" placeholder="Escribe el nombre de un cóctel...">
                        <span class="input-group-text bg-transparent border-0 position-absolute" style="right: 10px; z-index: 5;">
                            <i class="fas fa-search"></i>
                        </span>
                    </div>
                    <div class="search-info text-center mt-2">
                        <span id="searchType">Búsqueda por nombre</span> • 
                        <span id="resultCount">0 resultados</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Results -->
        <div id="resultsContainer" class="row"></div>
        
        <!-- Loading Spinner -->
        <div id="loading" class="text-center my-5" style="display: none;">
            <div class="spinner-border loading-spinner" role="status">
                <span class="visually-hidden">Cargando...</span>
            </div>
            <p class="mt-3">Buscando cócteles...</p>
        </div>
    </div>
    
    <!-- Scroll to Top Button -->
    <div class="floating-btn" id="scrollToTop">
        <i class="fas fa-arrow-up"></i>
    </div>

    <!-- Toast for Messages -->
    <div class="toast align-items-center" id="messageToast" role="alert">
        <div class="d-flex">
            <div class="toast-body" id="toastMessage"></div>
            <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast"></button>
        </div>
    </div>

    <!-- Instructions Modal -->
    <div class="modal fade" id="instructionsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalCocktailName"></h5>
                    <button type="button" class="btn-close close-btn" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <img id="modalImage" src="" class="img-fluid rounded" alt="">
                            <div class="mt-3">
                                <h6>Categoría: <span id="modalCategory"></span></h6>
                                <h6>Tipo: <span id="modalAlcoholic"></span></h6>
                                <h6>Copa: <span id="modalGlass"></span></h6>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h5 class="text-accent">Instrucciones</h5>
                            <p id="modalInstructions" class="mb-4"></p>
                            
                            <h5 class="text-accent">Ingredientes</h5>
                            <ul class="ingredient-list" id="modalIngredients"></ul>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap & jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Variables globales
        let currentSearchType = 'name';
        let searchTimeout = null;
        let allDrinks = [];
        
        $(document).ready(function() {
            // Initialize tooltips
            $('[data-bs-toggle="tooltip"]').tooltip();
            
            // Set up search input with debounce
            $('#searchInput').on('input', function() {
                clearTimeout(searchTimeout);
                const searchTerm = $(this).val().trim();
                
                if (searchTerm.length === 0) {
                    $('#resultsContainer').html('');
                    $('#resultCount').text('0 resultados');
                    return;
                }
                
                // For first letter search, only allow one character
                if (currentSearchType === 'first-letter' && searchTerm.length > 1) {
                    $(this).val(searchTerm.charAt(0));
                    showMessage('La búsqueda por primera letra solo acepta un carácter');
                    return;
                }
                
                // Show loading indicator
                $('#loading').show();
                
                // Set timeout for debounce (500ms)
                searchTimeout = setTimeout(() => {
                    searchCocktails(searchTerm, currentSearchType);
                }, 500);
            });
            
            // Filter button click handler
            $('.filter-buttons button').on('click', function() {
                $('.filter-buttons button').removeClass('active');
                $(this).addClass('active');
                
                currentSearchType = $(this).data('filter');
                $('#searchType').text(
                    currentSearchType === 'name' ? 'Búsqueda por nombre' :
                    currentSearchType === 'ingredient' ? 'Búsqueda por ingrediente' :
                    'Búsqueda por primera letra'
                );
                
                // Trigger search again if there's a search term
                const searchTerm = $('#searchInput').val().trim();
                if (searchTerm.length > 0) {
                    searchCocktails(searchTerm, currentSearchType);
                }
            });
            
            // Scroll to top button
            $('#scrollToTop').on('click', function() {
                $('html, body').animate({ scrollTop: 0 }, 500);
            });
            
            // Show scroll button when scrolling down
            $(window).on('scroll', function() {
                if ($(this).scrollTop() > 200) {
                    $('#scrollToTop').fadeIn();
                } else {
                    $('#scrollToTop').fadeOut();
                }
            });
            
            // Load popular cocktails on initial load
            loadPopularCocktails();
        });
        
        // Search cocktails based on type
        async function searchCocktails(searchTerm, type) {
            try {
                let url;
                
                switch(type) {
                    case 'name':
                        url = `https://www.thecocktaildb.com/api/json/v1/1/search.php?s=${searchTerm}`;
                        break;
                    case 'ingredient':
                        url = `https://www.thecocktaildb.com/api/json/v1/1/filter.php?i=${searchTerm}`;
                        break;
                    case 'first-letter':
                        url = `https://www.thecocktaildb.com/api/json/v1/1/search.php?f=${searchTerm}`;
                        break;
                }
                
                const response = await fetch(url);
                const data = await response.json();
                
                $('#loading').hide();
                
                if (data.drinks === null) {
                    $('#resultsContainer').html(`
                        <div class="col-12 text-center">
                            <div class="alert alert-warning">
                                No se encontraron resultados para "${searchTerm}"
                            </div>
                        </div>
                    `);
                    $('#resultCount').text('0 resultados');
                    return;
                }
                
                allDrinks = data.drinks;
                displayResults(allDrinks);
                $('#resultCount').text(`${allDrinks.length} resultado(s)`);
            } catch (error) {
                console.error('Error:', error);
                $('#loading').hide();
                showMessage('Error al buscar cócteles. Intenta nuevamente.');
            }
        }
        
        // Display results in the container
        function displayResults(drinks) {
            const resultsContainer = $('#resultsContainer');
            resultsContainer.html('');
            
            drinks.forEach(drink => {
                const card = `
                    <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                        <div class="cocktail-card">
                            <div class="position-relative">
                                <img src="${drink.strDrinkThumb}" class="cocktail-image" alt="${drink.strDrink}">
                                <div class="alcohol-indicator">
                                    ${drink.strAlcoholic === 'Alcoholic' ? '🍸 Alcohólico' : '🍹 Sin alcohol'}
                                </div>
                                <div class="search-type-badge">
                                    ${currentSearchType === 'name' ? 'Nombre' : currentSearchType === 'ingredient' ? 'Ingrediente' : 'Letra'}
                                </div>
                            </div>
                            <div class="p-3">
                                <h5 class="cocktail-name">${drink.strDrink}</h5>
                                <p class="text-light">${drink.strCategory || ''}</p>
                                <button class="btn instructions-btn w-100" data-id="${drink.idDrink}">
                                    <i class="fas fa-list-ol"></i> Ver instrucciones
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                resultsContainer.append(card);
            });
            
            // Add event listeners to the instruction buttons
            $('.instructions-btn').on('click', function() {
                const drinkId = $(this).data('id');
                showDrinkDetails(drinkId);
            });
        }
        
        // Show drink details in modal
        async function showDrinkDetails(drinkId) {
            try {
                const response = await fetch(`https://www.thecocktaildb.com/api/json/v1/1/lookup.php?i=${drinkId}`);
                const data = await response.json();
                
                if (data.drinks && data.drinks[0]) {
                    const drink = data.drinks[0];
                    
                    // Set modal content
                    $('#modalCocktailName').text(drink.strDrink);
                    $('#modalImage').attr('src', drink.strDrinkThumb);
                    $('#modalCategory').text(drink.strCategory);
                    $('#modalAlcoholic').text(drink.strAlcoholic);
                    $('#modalGlass').text(drink.strGlass);
                    
                    // Use Spanish instructions if available, otherwise use English
                    const instructions = drink.strInstructionsES || drink.strInstructions || 'No hay instrucciones disponibles.';
                    $('#modalInstructions').text(instructions);
                    
                    // Add ingredients and measures
                    const ingredientsList = $('#modalIngredients');
                    ingredientsList.html('');
                    
                    for (let i = 1; i <= 15; i++) {
                        const ingredient = drink[`strIngredient${i}`];
                        const measure = drink[`strMeasure${i}`];
                        
                        if (ingredient && ingredient.trim() !== '') {
                            ingredientsList.append(`
                                <li>${measure ? measure : ''} ${ingredient}</li>
                            `);
                        }
                    }
                    
                    // Show the modal
                    $('#instructionsModal').modal('show');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Error al cargar los detalles del cóctel');
            }
        }
        
        // Load popular cocktails on initial load
        async function loadPopularCocktails() {
            try {
                const response = await fetch('https://www.thecocktaildb.com/api/json/v1/1/search.php?s=');
                const data = await response.json();
                
                if (data.drinks) {
                    allDrinks = data.drinks.slice(0, 8); // Get first 8 drinks
                    displayResults(allDrinks);
                    $('#resultCount').text(`${allDrinks.length} resultado(s)`);
                }
            } catch (error) {
                console.error('Error loading popular cocktails:', error);
            }
        }
        
        // Show message toast
        function showMessage(message) {
            $('#toastMessage').text(message);
            $('.toast').toast('show');
        }
    </script>
</body>
</html>